**Prettier 2.0.5**
[Playground link](https://prettier.io/playground/#N4Igxg9gdgLgprEAuEBiABAEQugmhAV3QDEAnaGAfnVQB0p6BtAQkYHEBLGACQICN0AIQIcANgBN0AZRgBDGAQDOAXQAUACxgwADoqQB6fQHMu6-gDpIAW30AFWYrCzRAWgAMADwCcb-eICeZBT6AO4QpADWAGaiECGK+nwiEomy4kZw5ooAbkYAlGqaOnqGJjBmfJYQNvaOzu7evgFBsPqyYDAc0Ip5TKwAwhDZcKSyGdJyCioaWroG+pDDo6KiiuZd+qRw2hAJZRV2Dk6unj5+geStfGkZWbmUfKNQYOoAvOJww7HaBTPF84sRs5VusIMZTPxDnUTo1zi0qI9ZM83h8vhAfn1GAAVCByUToZwjGDTIpzQwcKxGLLqDhwCRrDaiIwwGyE0jE4xQ44NM7NS4wO5GSixIwQV5MlkAMhFEAA6hxxOVXgBGAAcv1JJX0EqsVRs2nIACs4B09lz6qcmhdgmyOb0oCxGAAZJFGAhjODoIyjD5IdC2fzlaCFWZailUxQ0uniBlgnXGH1wfTaQPqaCc2rcy1w-mC4UQUXi5lWaUFuUKpVqjWh+Y6vXJo0mjlGc0w3nW1qQWBwDwwJApoNQe2OgDSUDiUHQADUCKIoEC+GIuLSSTXDIooP4IqD9PBFDBweVIZmLbC+cFUXT0al0pkcvkQ-915vtxs9wf9sejqf2-D7fQAANz1gACABp0HCdBaBAbB0H8QgSH5ShoPAjhFAJdAYAgCB8Sw9A6knJFJA+eAOkw9RPVkRdRC4fxMJwJRPWwKxZA4Sd4TYoxwOgDDxGqVioHMdAgI7GAAPQJxJ0UWRhnQLZFFnYl6IwqIxE9SDDSUGAIIIHRdOU-c+N0oT6EA4CxPQEIHHQS9vjgSQ8Io0RtAg0gjCRDgAC95C6KB0PENDAVIdAOCici4A4YK033eybP4tj0NkLZ8KUMBtk6PhRE9PDmIExCKE4oTcrY9Aon5TiQsSwitHaCJLJpF4CRWOJ0KiSCwEisACCsYZYF8iCwr4liSsyiAwAidDFDgbSSu0UR2k9Pg6NUrYrJWNZ0FlCjktkUrIrgNb8RYujRvGjDGOCsrqgJMA0sURQKoAqiwHEPVxJCBr1HQRj0P6TAADl0AAUWINhwKGvKAM8-wPDe+qOEatD0HHbTToiWKePKT0TF6vbVuBAkoEkZxFAYqb0JBsHzqm4LJJuu70KevgXrhpbvoeqAjDi4bJyuvrOcJyQWIiCqsbxg6CfKNi6qhmG4aRvgIoF9oGdihL4DSIrpqbCrQrgwhgohkqkYUxx0o4TLspwKX0KRikdnZJFtLa4KCCJkZ9yIiqdngPrnDkwg91KyDBisFiicF9BBlgchcNGKJVLAdA2euYmOnCdCPpwY7k89HtVNEGBRk6AW2JdljOkxnAkSa+BSCgeRPSNydynIAgjC+3ai602Lm-1ogJxMhgoFQDA2GmkuuZkJL4EkUezNE8StgARxEeT0AAKg3gNB3QABmcwAHYAGot6Ene00nAAmSrkdxFLtAd2ehIAHkSUgAD4F-hcS6cVkK-J4iysTRK6ArAQHELOT0ShHraA4NocSRFwrCRXmvOAVgEDEnMDAXs4kC6ehKmLLYOwHpYVIP4Ie9BR4YAAJKAOBLFayu1wGQKyjQeeUARI-wkjXf+6sGGSGyBwXacDtBIEAgBAC1xIz0FEQAz2Kx0AuGCqg-aGDYBrBwTACRAF6A0O0nTLGk5-6kDdjZfaHRRD+HEZwyR0j1D0HMugGi+4vQQkqNYHR9At7-VxHAJAW90D6Nvlsaw6iPgOTJpRdAA5L7oCEeyd0+IEAJOgOo7SeF+GKJYVAqqkh0bbH7sFFJkU0mYIkllJEQkaFhXgkQEIaEvp4T4vhCA4E6mWTEPiecsVGAphSY+Mkh4Kj1n6VAbIyZ-ApLyJHMWfSpnjJcAkhQhJxkxNEO3NigytSfg8dUSZKSDmLOWUk6ZMTSBdGCpk+hKxRYUTARAqBlCR6j3QAAVWkuMJBPZZBWDmnAdC1CdH2McaJPabCX74LoR-dAjAXA4GIDQp0QNlCgvhM4tC2l0Av2bh-cw+LYXwpIEilFpkiZgvwdzASmjexKJwIHbQukAD6fM5CW2wb2NF-IMWuPEOoNYopsgSTQrIcwgq6U6T0jAFl-IqJZQ5do8l6KXEGJFWKoYXiXmvIAPLaErn5dhHDJEATmgJeAnLJxKK+i4FwTkXLoAdY6p1jqpBphCORJGGD7oenMPQB1NqlgPR4s6kNDrXVxGQV1UgWxYDxI9r5X1lqiWIuRUo+FulGUwFeCmoGDqan4W0CaUKtJxDgSMcggAUlIbVgMGX6UpQ0xRis-WhtbW2qaGTrb3MUIWjqqlYrZGcAQTImrqEYCkL8-56BtUZv0mO4FDgHFQAulfAAAvwN2CgkAAD8AAkNkwUqokggRQ-hYz0GVFgeKBqpzOAVI3cQ9BgAtoddBcQjdoJ+mgm4AAbPoNwXh9BXzcMB8CbhVRIAACwQcg24FCL6oIgGbooT96Bn2WpDdBNKfkz2glQ+httjroI0NsKh6CAByZUbhIPmCvj+8wyplS0cgwAVnI+BSj1HaP0ao8xtjHHlSHyvuYH9h8ROqnMKqZU5H4MYbbdBaeUwyMwWvflWAcq4CycI6+8A4g-LKfI5YWIBBxAxCSpkawMmQCgQQ62rDenFBMqWkyhuXqDP9GM6Z+aWwrO2cdQAXwQ4FqAwXjVUIwNwCN2AAUhW0rKcIERkKcPMuJBW5B0aTjYnhVucBPRTQ6L5PQ3iD3wnI+hHmck3bzkumpRNtAYAb2nHe99QckHhHclALyMW2KZtnlShKdWGvTtIC8AFRdG7oTFoxAayCOICyBpzNinoGnlHwtNGbyHBuNZnVK0qsrLb9YNSVKtNaDIwCMtpJBeFdqUr1lNLKz8oJQEa1ie5c2uYLZMPOLbw2OtdcSoo5DADruIZ9tBH7AF+gUSiO9Lp7Nsr3L+oDTA2sCs8RooichykIB8DkCVAmSPWqQTgO0L6zcIdQ7gDD8Kk5TEGqRM4M9SM8IduQXwbClTJwAVZRp8Sg6NkELClwGyqPWuHdvjzg7SCtgKHrpN+5R6ICDWveha4Z1sv3Lp9V8FI7ntRwBlgUXCbTJDflIoxwoxC02XkDd8gVgbH1fq417gWIsS2CkNIEYSx0DcBJx8UgawTdO6jv9AAggAWVzaE8IMZBvB-+r8gFXuPbvKmq9IPpvuDapoR7lroqTeNaCFYdAJPGpK-ClNVC2k6egNUpzEYBosv4UMTgBUmDQp0SRHRQnIu69qy5y9KATKuyqSpCmd6n0wGyBOnl-g+4Lmc1tn5NvM2xZ5+Dm7SQ21MhPfC+gcP4RPR0JcCjvVX0nTYTqvIK9FX3v0FeyMSiO14lJWEfAAk4DN0zZ+sHYKxV2LlSczgRXTF5LTaAOAcxczYakwB40guR4QwKlwzSThhJIJIJdhFw4QSTVBWBuwIw+TdDKRgEQFyRjYXJo4Grl43b7SHTJx0TCwVTTZUHi4fQIxfTM6mIxTEwRzAhxAVRhJ4FOD6o07KRTadbdjuySAhBwB8CkI75SAECNQ-J-JZToR-x5a5aZaThuqwqh62BYhXxeBT4NwZCSCoE8ERwYGxzbLzAhB2HmArS5ZTL1ijQtg5byDKJJ5JQvBAZuCCb-p7xtB6qGFMrNwyoFSCSaBWCiB5BDxvyPAfzxGfz373JtTNQNLKzP4qoVTl7yQGx3TwyNSijA7ZyH4i5474hUSBz1TX59ysq6yKDgQ6HC7qHw6lqRxhI8QYJBgxi-7lE6zQA2KNaMD-5qaTwAIYTLrEhOSiA2GGB2EhDmBERbCyAuwKANzmDta+Fqj-osb-qHx+DXouD1GcwuBsQuCyAuBTGRh0iiD6D2jDGh7oBUaXo8SjHvZzF+AcAmDmDiGGiyCJAiiHE8zhH8xj7qAYh64jGqbvboBYgmjqCdaryehYiMZCZKL740JYgABKuaoeruko-QI4iEieYQkQnx8gcg405gVgXAWwmxbku4CJSJw6CQqJgmV89xxWjAggsQ40nEnhD0nssaocuBnWQh-Ur2bcHcN+eUHxfwQyCx5g1wVgpMUQMAVk9J1gyYsghaAe+gJxLYDxsK7xgBXMLgm0HAIshaAUsgnxCA5gDS1p9kwiDJLYTpHA+g-+oJk8-4LyUcFAFySQ4xHC9Asoy2dI1gnoVhFsukhWzADqtglSU0a2nojA2+ag-QNaOJNCggbyWINC-0bANJ4gMyLsji00rEIIZKryToCMJ6nooZUAr2SMBoEAxoZEdsLc9yZJEgDSHwsKjKmUCMh2agToNC-QQM-0UgQMsRZKLZ6EbZHZM0S+yCQ5NEScfcK2NI3ZnobynWfWimAK4ERE9AkAKYFyHcl2EcWw80fWl5mgq5YsZJdUvZ4g-ZT+y2rEwwDk6g0pS6cy-Q-Qbgzx5gIF+5HAga-s65I5zcFZAUEpwYCpWoYAKxnQwwnRfkbpyY-AG5zc+gnkIwYITGvgc5w8oeiiMZwZhWohNIi5jYZEja+IJidIJOae307sVyiOwF8F+B+qQkggdECkfAtJWgFUIis4+IqCY27SCE5mBI3ouWosOA1gc0-g9A25Hqmc35IwM255-gD5yBdcY2ia1mIA6I+qigyAoASU5AIQ9gMaVlKAzgVkZ6ZliI4000Ug4BHUnMyA3ccAoEIAURogW0XAAKPlcAUgJ6y4QiMA-gyA4A90ZlCURItgowRgLEyAUQJMgVIAhoigHgggownlMAE6GCdZ842VuVQVBVHgUgnEWUAAigQH4tVasHleAQHiMIlSxJEHxCEFAGZY3rAPKIqOoMgKqG4EFW2VNLKJbolQaEnqQMMGZavH4uleiE5SAA4FcblhEmZaolsOlWMFlUgDlR1UFVNLSf5aYnlZAc1a1fAO1ZXiAGymNeUMgFfEFeNkuJzKKbIIlQCixmZYxFiFRE5Rda9dkMOnQh8LAFIKhfAjAKHkTDIP4FlC9XAP5v5kAA)
```sh
--parser markdown
```

**Input:**
````markdown
# Do You Front? #

[![GitHub Build Status](https://github.com/Pascal-0x90/dyFront/workflows/build/badge.svg)](https://github.com/Pascal-0x90/dyFront/actions)
[![Coverage Status](https://coveralls.io/repos/github/Pascal-0x90/dyFront/badge.svg?branch=develop)](https://coveralls.io/github/Pascal-0x90/dyFront?branch=develop)
[![Total alerts](https://img.shields.io/lgtm/alerts/g/Pascal-0x90/dyFront.svg?logo=lgtm&logoWidth=18)](https://lgtm.com/projects/g/Pascal-0x90/dyFront/alerts/)
[![Language grade: Python](https://img.shields.io/lgtm/grade/python/g/Pascal-0x90/dyFront.svg?logo=lgtm&logoWidth=18)](https://lgtm.com/projects/g/Pascal-0x90/dyFront/context:python)
[![Known Vulnerabilities](https://snyk.io/test/github/Pascal-0x90/dyFront/develop/badge.svg)](https://snyk.io/test/github/Pascal-0x90/dyFront)

`dyFront`, or "Do you Front?", is a tool to scan and detect the ability to use Domain Fronting, on a domain. `dyFront` can save results to a file or just output to stdout. 

`dyFront` was developed to help organizations discover if their hosted domains are susceptible to Domain Fronting. Domain fronting is an attack which allows for circumvention of domain blocks set in place by firewalls. Where a firewall may block a user from accessing `abcd.com` which uses CDN EFG, domain `zyx.com` which is not blocked on the given firewall and also uses EFG, a user can access `abcd.com` by using domain fronting and making the firewall think `zyx.com` is being accessed instead. Detecting if your domain is susceptible to this is important for understanding potential routes for Command and Control traffic by bad actors who may be exfiltrating information to an alternate domain through a trusted domain you own. 

## Getting Started ##
`dyFront` requires **Python 3.7+**. Python 2 is not supported. </br>
`dyFront` can be installed as a module using `pip` and the `requirements.txt` file in the repository. 

### Installed as a module ###
`dyFront` can be installed via pip:
```bash
pip install -r requirements.txt
```
It can then be run directly:
```bash
dyFront list github.com
```
**Note:** It is recommended to use a python virtual environment to install modules and keep your environment clean. If you wish to do so, you will need [pyenv](https://github.com/pyenv/pyenv) and the [pyenv-virtualenv plugin](https://github.com/pyenv/pyenv-virtualenv) prior to installing the module. 

### Usage and examples ###
```bash
dyFront file <fileIn> [-o FILE]
dyFront list  <domain>... [-o FILE]

dyFront file domains.txt -o output_frontable.txt
dyFront list dhs.gov cisa.gov -o output_frontable.txt
dyFront list cisa.gov
```
#### Options ####
```plaintext
  -h --help              Show this message.
  --version              Show the current version.
  -o FILE --output=FILE  If specified, then the JSON output file will be
                         set to the specified value.
```
#### Sample Output ####
```bash
user2@ubuntu:~$ dyFront list censys.io
1 Domains Validated
{
    "date": "06/09/2020, 08:48:40",
    "domains": {
        "censys.io": {
            "IP": "'104.26.11.245', '104.26.10.245', '172.67.68.81'",
            "Status": "Domain Frontable",
            "cdns": "'.cloudflare.com'",
            "cdns_by_names": "'Cloudflare'"
        }
    }
}
```
## How Does it Work?
`dyFront` is broken into three sections:
* dyFront's main runner file.
	* Validates and organizes inputted domains.
	* Orchestrates the use of the Fronting Engine with set of domains.
	* Output frontable domains in JSON to stdout and to a file if seleted. 
* The Fronting Engine.
	* Organizes all domains into a "pot".
	* `Chef` will use the CDN Detection library to obtain all CDNs for each domain.
	* `Chef` then runs analysis to set the boolean `frontable` value if it detectes a domain is frontable and returns the list of domains back to the runner file.
* CDN Detection.
	* Will scrape data from:
		* HTTPS Server Headers.
		* CNAME records.
		* Nameservers Used.
		* WHOIS data.
	* From each of these, it runs a fingerprint scan to identify any CDNs defined in `cdn_config.py` which may be substrings inside of the data found here. 

## More In-Depth Look at Domain Fronting
There are a variate amount of uses for Domain Fronting, from bypassing censorship to using it in command and control communications to bypass restrictions of a firewall by making use of a domain which is trusted and allowing communication then to the unintended website. Such examples can be seen in how [APT29 managed command and control](https://www.fireeye.com/blog/threat-research/2017/03/apt29_domain_frontin.html). 
</br></br>
The following are a listing of resources which go into more detail about what domain fronting is, how it can be used, and common methods for detection:
* [Domain Fronting in a nutshell](https://www.andreafortuna.org/2018/05/07/domain-fronting-in-a-nutshell/)
* [A 101 on Domain Fronting](https://digi.ninja/blog/domain_fronting.php)
* [Domain Fronting Technique T1172 - MITRE ATT&CK Framework](https://attack.mitre.org/techniques/T1172/)
* [Blocking-resistant Communication Through Domain Fronting](https://www.bamsoftware.com/papers/fronting/)
* [Domain Fronting - Wikipedia](https://en.wikipedia.org/wiki/Domain_fronting)

## Contributing ##

We welcome contributions!  Please see [here](CONTRIBUTING.md) for
details.

## License ##

This project is in the worldwide [public domain](LICENSE).

This project is in the public domain within the United States, and
copyright and related rights in the work worldwide are waived through
the [CC0 1.0 Universal public domain
dedication](https://creativecommons.org/publicdomain/zero/1.0/).

All contributions to this project will be released under the CC0
dedication. By submitting a pull request, you are agreeing to comply
with this waiver of copyright interest.

````

**Output:**
````markdown
# Do You Front?

[![GitHub Build Status](https://github.com/Pascal-0x90/dyFront/workflows/build/badge.svg)](https://github.com/Pascal-0x90/dyFront/actions)
[![Coverage Status](https://coveralls.io/repos/github/Pascal-0x90/dyFront/badge.svg?branch=develop)](https://coveralls.io/github/Pascal-0x90/dyFront?branch=develop)
[![Total alerts](https://img.shields.io/lgtm/alerts/g/Pascal-0x90/dyFront.svg?logo=lgtm&logoWidth=18)](https://lgtm.com/projects/g/Pascal-0x90/dyFront/alerts/)
[![Language grade: Python](https://img.shields.io/lgtm/grade/python/g/Pascal-0x90/dyFront.svg?logo=lgtm&logoWidth=18)](https://lgtm.com/projects/g/Pascal-0x90/dyFront/context:python)
[![Known Vulnerabilities](https://snyk.io/test/github/Pascal-0x90/dyFront/develop/badge.svg)](https://snyk.io/test/github/Pascal-0x90/dyFront)

`dyFront`, or "Do you Front?", is a tool to scan and detect the ability to use Domain Fronting, on a domain. `dyFront` can save results to a file or just output to stdout.

`dyFront` was developed to help organizations discover if their hosted domains are susceptible to Domain Fronting. Domain fronting is an attack which allows for circumvention of domain blocks set in place by firewalls. Where a firewall may block a user from accessing `abcd.com` which uses CDN EFG, domain `zyx.com` which is not blocked on the given firewall and also uses EFG, a user can access `abcd.com` by using domain fronting and making the firewall think `zyx.com` is being accessed instead. Detecting if your domain is susceptible to this is important for understanding potential routes for Command and Control traffic by bad actors who may be exfiltrating information to an alternate domain through a trusted domain you own.

## Getting Started

`dyFront` requires **Python 3.7+**. Python 2 is not supported. </br>
`dyFront` can be installed as a module using `pip` and the `requirements.txt` file in the repository.

### Installed as a module

`dyFront` can be installed via pip:

```bash
pip install -r requirements.txt
```

It can then be run directly:

```bash
dyFront list github.com
```

**Note:** It is recommended to use a python virtual environment to install modules and keep your environment clean. If you wish to do so, you will need [pyenv](https://github.com/pyenv/pyenv) and the [pyenv-virtualenv plugin](https://github.com/pyenv/pyenv-virtualenv) prior to installing the module.

### Usage and examples

```bash
dyFront file <fileIn> [-o FILE]
dyFront list  <domain>... [-o FILE]

dyFront file domains.txt -o output_frontable.txt
dyFront list dhs.gov cisa.gov -o output_frontable.txt
dyFront list cisa.gov
```

#### Options

```plaintext
  -h --help              Show this message.
  --version              Show the current version.
  -o FILE --output=FILE  If specified, then the JSON output file will be
                         set to the specified value.
```

#### Sample Output

```bash
user2@ubuntu:~$ dyFront list censys.io
1 Domains Validated
{
    "date": "06/09/2020, 08:48:40",
    "domains": {
        "censys.io": {
            "IP": "'104.26.11.245', '104.26.10.245', '172.67.68.81'",
            "Status": "Domain Frontable",
            "cdns": "'.cloudflare.com'",
            "cdns_by_names": "'Cloudflare'"
        }
    }
}
```

## How Does it Work?

`dyFront` is broken into three sections:

- dyFront's main runner file.
  _ Validates and organizes inputted domains.
  _ Orchestrates the use of the Fronting Engine with set of domains. \* Output frontable domains in JSON to stdout and to a file if seleted.
- The Fronting Engine.
  _ Organizes all domains into a "pot".
  _ `Chef` will use the CDN Detection library to obtain all CDNs for each domain. \* `Chef` then runs analysis to set the boolean `frontable` value if it detectes a domain is frontable and returns the list of domains back to the runner file.
- CDN Detection.
  _ Will scrape data from:
  _ HTTPS Server Headers.
  _ CNAME records.
  _ Nameservers Used.
  _ WHOIS data.
  _ From each of these, it runs a fingerprint scan to identify any CDNs defined in `cdn_config.py` which may be substrings inside of the data found here.

## More In-Depth Look at Domain Fronting

There are a variate amount of uses for Domain Fronting, from bypassing censorship to using it in command and control communications to bypass restrictions of a firewall by making use of a domain which is trusted and allowing communication then to the unintended website. Such examples can be seen in how [APT29 managed command and control](https://www.fireeye.com/blog/threat-research/2017/03/apt29_domain_frontin.html).
</br></br>
The following are a listing of resources which go into more detail about what domain fronting is, how it can be used, and common methods for detection:

- [Domain Fronting in a nutshell](https://www.andreafortuna.org/2018/05/07/domain-fronting-in-a-nutshell/)
- [A 101 on Domain Fronting](https://digi.ninja/blog/domain_fronting.php)
- [Domain Fronting Technique T1172 - MITRE ATT&CK Framework](https://attack.mitre.org/techniques/T1172/)
- [Blocking-resistant Communication Through Domain Fronting](https://www.bamsoftware.com/papers/fronting/)
- [Domain Fronting - Wikipedia](https://en.wikipedia.org/wiki/Domain_fronting)

## Contributing

We welcome contributions! Please see [here](CONTRIBUTING.md) for
details.

## License

This project is in the worldwide [public domain](LICENSE).

This project is in the public domain within the United States, and
copyright and related rights in the work worldwide are waived through
the [CC0 1.0 Universal public domain
dedication](https://creativecommons.org/publicdomain/zero/1.0/).

All contributions to this project will be released under the CC0
dedication. By submitting a pull request, you are agreeing to comply
with this waiver of copyright interest.

````
